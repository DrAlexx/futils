<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.9.1"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Futils: ScopedProfiler</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">Futils
   &#160;<span id="projectnumber">0.0.1</span>
   </div>
   <div id="projectbrief">My collection of usefull utils</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.1 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search','.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(document).ready(function(){initNavTree('group___scoped_profiler.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#nested-classes">Classes</a>  </div>
  <div class="headertitle">
<div class="title">ScopedProfiler</div>  </div>
</div><!--header-->
<div class="contents">

<p>This is a small one-header library for measuring of the execution time of your program elements.  
<a href="#details">More...</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="nested-classes"></a>
Classes</h2></td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">class &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_scoped_profiler_1_1_manager.html">ScopedProfiler::Manager</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">The <a class="el" href="class_scoped_profiler_1_1_manager.html" title="The Manager class is a collection of ScopedPoint`s.">Manager</a> class is a collection of ScopedPoint`s.  <a href="class_scoped_profiler_1_1_manager.html#details">More...</a><br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">class &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_scoped_profiler_1_1_scoped_point.html">ScopedProfiler::ScopedPoint&lt; mgr, name &gt;</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">It is a time measurement point.  <a href="class_scoped_profiler_1_1_scoped_point.html#details">More...</a><br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<p>The library is required C++17 compiler and C++ standard library only. The time measurement is based on std::high_resolution_clock. Every measurement point has an unique name and two values:</p><ul>
<li>call_count is a number of calls for this point</li>
<li>cumulative_time_us is a sum of execution time for all calls in us. You can get an average execution time per a call via the equation cumulative_time_us/call_count.</li>
</ul>
<p>How to use: Create Manager instance. This is a collection of measurement points. Create ScopedPoint instance in the scope where you want to measure time. ScopedPoint is an template class that have to be specialized with the help of Manager instance and point name. </p><dl class="section note"><dt>Note</dt><dd>Manager instance must be global. </dd>
<dd>
point name must be a 'static const char'. Also point name must be unique inside manager instance.</dd></dl>
<p>Multithreading is supported with some exceptions:</p><ul>
<li>Any measurement point ScopedPoint is thread safe and hasn't got any kind of locks inside. All synchronization is based on atomics, so the time measurement doesn't take a lot of time.</li>
<li>Manager::for_each_point can be called in any time but when some point is updating his own state it can provide the inconsistent data. (but no crash or memory corruption here) It will be a good idea to divide the time measurement and data statistic processing. But it's not a strict requirement.</li>
<li>Manager::reset is completely not thread-safe. If you definitely want to reset all data you must ensure that any points don't change the data in the same time. (but no crash or memory corruption here)</li>
</ul>
<p>Example: </p><div class="fragment"><div class="line"><span class="preprocessor">#include &lt;scoped_profiler.h&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;ostream&gt;</span></div>
<div class="line"> </div>
<div class="line"><a class="code" href="class_scoped_profiler_1_1_manager.html">ScopedProfiler::Manager</a> mgr;</div>
<div class="line"> </div>
<div class="line"><span class="keywordtype">void</span> foo() {</div>
<div class="line">    <span class="keyword">static</span> <span class="keyword">const</span> <span class="keywordtype">char</span> point_name[] = <span class="stringliteral">&quot;Function foo&quot;</span>;</div>
<div class="line">    <a class="code" href="class_scoped_profiler_1_1_scoped_point.html">ScopedProfiler::ScopedPoint&lt;mgr, point_name&gt;</a>    my_foo_point;</div>
<div class="line"> </div>
<div class="line">    <span class="comment">//do something here</span></div>
<div class="line">};</div>
<div class="line"> </div>
<div class="line"><span class="keywordtype">int</span> main(<span class="keywordtype">int</span> argc, <span class="keywordtype">char</span>** argv) {</div>
<div class="line">    {</div>
<div class="line">        <span class="keyword">static</span> <span class="keyword">const</span> <span class="keywordtype">char</span> point_name[] = <span class="stringliteral">&quot;anon scope in main&quot;</span>;</div>
<div class="line">        <a class="code" href="class_scoped_profiler_1_1_scoped_point.html">ScopedProfiler::ScopedPoint&lt;mgr, point_name&gt;</a>    my_anon_point;</div>
<div class="line"> </div>
<div class="line">        <span class="comment">//do something;</span></div>
<div class="line"> </div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="comment">//print results</span></div>
<div class="line">    mgr.<a class="code" href="class_scoped_profiler_1_1_manager.html#af9d368195105a6f5039b0ab2f5cbbbcc">for_each_point</a>([](<span class="keyword">const</span> <span class="keywordtype">char</span>* name, uint64_t call_count, uint64_t cumulative_time_us){</div>
<div class="line">        std::cout &lt;&lt; <span class="stringliteral">&quot;Point: &quot;</span> &lt;&lt; name &lt;&lt; <span class="stringliteral">&quot;count: &quot;</span> &lt;&lt; call_count &lt;&lt; <span class="stringliteral">&quot;cumulative_time: &quot;</span> &lt;&lt; cumulative_time_us &lt;&lt; <span class="stringliteral">&quot;us&quot;</span> &lt;&lt; std::endl;</div>
<div class="line">    });</div>
<div class="line">    <span class="keywordflow">return</span> 0;</div>
<div class="line">}</div>
<div class="ttc" id="aclass_scoped_profiler_1_1_manager_html"><div class="ttname"><a href="class_scoped_profiler_1_1_manager.html">ScopedProfiler::Manager</a></div><div class="ttdoc">The Manager class is a collection of ScopedPoint`s.</div><div class="ttdef"><b>Definition:</b> scoped_profiler.h:92</div></div>
<div class="ttc" id="aclass_scoped_profiler_1_1_manager_html_af9d368195105a6f5039b0ab2f5cbbbcc"><div class="ttname"><a href="class_scoped_profiler_1_1_manager.html#af9d368195105a6f5039b0ab2f5cbbbcc">ScopedProfiler::Manager::for_each_point</a></div><div class="ttdeci">void for_each_point(F f)</div><div class="ttdoc">for_each_point is an enumerator that calls the functor f for every ScopedPoint which is linked to the...</div><div class="ttdef"><b>Definition:</b> scoped_profiler.h:103</div></div>
<div class="ttc" id="aclass_scoped_profiler_1_1_scoped_point_html"><div class="ttname"><a href="class_scoped_profiler_1_1_scoped_point.html">ScopedProfiler::ScopedPoint</a></div><div class="ttdoc">It is a time measurement point.</div><div class="ttdef"><b>Definition:</b> scoped_profiler.h:157</div></div>
</div><!-- fragment --> </div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">Generated on Wed May 12 2021 17:04:32 for Futils by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.1 </li>
  </ul>
</div>
</body>
</html>
